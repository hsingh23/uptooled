<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Browse handy utilities and preview them inline.">
  <meta name="keywords" content="tools, gallery, productivity">
  <title>Tool Gallery - UpTooled</title>
  <link rel="icon" href="favicon.png">
  <link rel="preload" href="tools.json" as="fetch" crossorigin>
  <link rel="preload" href="external-sites.json" as="fetch" crossorigin>
  <link rel="stylesheet" href="https://cdn.muicss.com/mui-latest/css/mui.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
  :root {
    --bg: #0a0e1a;
    --surface: #0f1623;
    --panel: #131b2e;
    --elev: #1a2337;
    --text: #e8eaed;
    --muted: #9ca3af;
    --border: #2a3447;
    --primary: #6366f1;
    --primary-light: #818cf8;
    --primary-dark: #4f46e5;
    --primary-contrast: #ffffff;
    --accent: #22d3ee;
    --accent-light: #67e8f9;
    --success: #10b981;
    --warning: #f59e0b;
    --danger: #ef4444;
    --shadow-1: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-2: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-3: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    --shadow-glow: 0 0 20px rgba(99, 102, 241, 0.3);
    --radius: 16px;
    --radius-sm: 12px;
    --radius-lg: 20px;
  }
  @media (prefers-color-scheme: light) {
    :root {
      --bg: #f8fafc;
      --surface: #ffffff;
      --panel: #f1f5f9;
      --elev: #f8fafc;
      --text: #0f172a;
      --muted: #64748b;
      --border: #e2e8f0;
      --primary: #6366f1;
      --primary-light: #818cf8;
      --primary-dark: #4f46e5;
      --primary-contrast: #ffffff;
      --accent: #06b6d4;
      --accent-light: #22d3ee;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --shadow-1: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-2: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-3: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-glow: 0 0 20px rgba(99, 102, 241, 0.2);
    }
  }
  * { box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    margin: 0;
    display: flex;
    flex-direction: column;
    height: 100vh;
    background: 
      radial-gradient(ellipse at top left, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
      radial-gradient(ellipse at bottom right, rgba(34, 211, 238, 0.1) 0%, transparent 50%),
      linear-gradient(135deg, var(--bg) 0%, var(--surface) 100%);
    color: var(--text);
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    letter-spacing: -0.01em;
    line-height: 1.6;
    overflow: hidden;
  }
  
  /* Scrollbar styling */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  ::-webkit-scrollbar-track {
    background: var(--panel);
  }
  ::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 4px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: var(--muted);
  }

  /* App bar */
  #topbar {
    position: sticky;
    top: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border);
    background: 
      linear-gradient(180deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0) 100%),
      var(--panel);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    box-shadow: var(--shadow-1);
  }
  #menu-button {
    appearance: none;
    border: 1px solid var(--border);
    background: var(--elev);
    color: var(--text);
    border-radius: var(--radius-sm);
    height: 44px;
    width: 44px;
    display: grid;
    place-items: center;
    box-shadow: var(--shadow-1);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 18px;
  }
  #menu-button:hover {
    background: var(--primary);
    color: var(--primary-contrast);
    border-color: var(--primary);
    transform: translateY(-1px);
    box-shadow: var(--shadow-2);
  }
  #topbar strong {
    font-weight: 800;
    font-size: 1.5rem;
    background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -0.02em;
  }
  #topbar .mui-textfield { margin: 0; flex: 1; max-width: 600px; }
  .mui-textfield input#search {
    background: var(--elev);
    border: 2px solid var(--border);
    color: var(--text);
    border-radius: var(--radius-lg);
    padding: 0.75rem 1rem 0.75rem 3rem;
    height: 48px;
    font-size: 15px;
    font-weight: 500;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    transition: all 0.2s ease;
  }
  .mui-textfield input#search::placeholder { 
    color: var(--muted); 
    font-weight: 400;
  }
  .mui-textfield input#search:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1), inset 0 2px 4px rgba(0,0,0,0.1);
  }
  .mui-textfield {
    position: relative;
  }
  .mui-textfield::before {
    content: '\f002';
    font-family: 'Font Awesome 6 Free';
    font-weight: 900;
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted);
    z-index: 1;
    font-size: 14px;
  }

  /* Layout */
  #content-wrapper {
    display: flex;
    flex: 1;
    overflow: hidden;
  }
  #sidebar {
    width: 320px;
    border-right: 1px solid var(--border);
    overflow-y: auto;
    padding: 1.5rem;
    background: var(--panel);
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  #main {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    min-width: 0;
    background: var(--surface);
  }
  
  /* Desktop layout - horizontal toolbar */
  @media (min-width: 769px) {
    #sidebar {
      width: 100%;
      height: auto;
      max-height: 200px;
      border-right: none;
      border-bottom: 1px solid var(--border);
      padding: 1rem 1.5rem;
      overflow-x: auto;
      overflow-y: hidden;
    }
    #content-wrapper {
      flex-direction: column;
    }
    #tool-list {
      display: flex;
      flex-direction: row;
      gap: 0.5rem;
      overflow-x: auto;
      overflow-y: hidden;
      padding: 0;
      white-space: nowrap;
    }
    #tool-list li {
      margin: 0;
      flex-shrink: 0;
    }
    #tool-list li a {
      white-space: nowrap;
      min-width: 200px;
    }
  }

  /* Sidebar list */
  #tool-list { margin: 0; padding: 0; }
  #tool-list li {
    margin: 0 0 0.25rem;
  }
  #tool-list li a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    color: var(--text);
    text-decoration: none;
    border-radius: var(--radius-sm);
    transition: all 0.2s ease;
    font-weight: 500;
    font-size: 14px;
    position: relative;
    overflow: hidden;
  }
  #tool-list li a::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 3px;
    height: 100%;
    background: var(--primary);
    transform: translateX(-100%);
    transition: transform 0.2s ease;
  }
  #tool-list li a:hover { 
    background: var(--elev);
    transform: translateX(4px);
  }
  #tool-list li a:hover::before {
    transform: translateX(0);
  }
  #tool-list li a:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }

  /* Grid */
  #grid-view {
    display: grid;
    gap: 1.5rem;
    padding: 2rem;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    overflow-y: auto;
    align-content: start;
  }
  @media (min-width: 1280px) {
    #grid-view { grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); }
  }
  .tool-card {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 1.5rem;
    box-shadow: var(--shadow-1);
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    height: 600px;
  }
  .tool-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--primary), transparent);
    transform: translateX(-100%);
    transition: transform 0.6s ease;
  }
  .tool-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-3);
    border-color: var(--primary);
    background: var(--elev);
  }
  .tool-card:hover::before {
    transform: translateX(100%);
  }
  .card-frame {
    width: 100%;
    height: 420px;
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    object-fit: cover;
    background: var(--bg);
    transition: all 0.3s ease;
  }
  .tool-card:hover .card-frame {
    border-color: var(--primary);
    box-shadow: var(--shadow-glow);
  }
  .tool-card h3 {
    margin: 0;
    font-size: 1.125rem;
    font-weight: 700;
    letter-spacing: -0.01em;
    line-height: 1.3;
    color: var(--text);
  }
  .tool-card p {
    margin: 0;
    font-size: 0.875rem;
    color: var(--muted);
    line-height: 1.5;
    flex: 1;
  }

  /* Viewer */
  #viewer { 
    display: none; 
    flex: 1; 
    flex-direction: column; 
    overflow: hidden;
    background: var(--surface);
  }
  #viewer-controls {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border);
    display: flex;
    gap: 0.75rem;
    align-items: center;
    background: var(--panel);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    position: sticky;
    top: 0;
    z-index: 10;
  }
  .mui-btn {
    border-radius: var(--radius-sm) !important;
    height: 40px;
    line-height: 40px;
    padding: 0 1.25rem;
    font-weight: 600;
    font-size: 14px;
    transition: all 0.2s ease;
    border: none;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }
  .mui-btn:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-2);
  }
  .mui-btn:active {
    transform: translateY(0);
  }
  .mui-btn--primary {
    background: var(--primary) !important;
    color: var(--primary-contrast) !important;
  }
  .mui-btn--primary:hover {
    background: var(--primary-dark) !important;
  }
  #tool-frame {
    flex: 1;
    border: none;
    width: 100%;
    background: var(--bg);
    border-radius: 0;
  }
  #viewer-placeholder {
    flex: 1;
    width: 100%;
    object-fit: cover;
    border: none;
    border-radius: 0;
    background: var(--bg);
  }
  #tool-info {
    padding: 1.5rem;
    border-top: 1px solid var(--border);
    background: var(--panel);
  }
  #tool-title {
    margin: 0 0 0.5rem;
    font-size: 1.375rem;
    font-weight: 800;
    letter-spacing: -0.02em;
    background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  #tool-description { 
    margin: 0.5rem 0; 
    color: var(--muted);
    font-size: 1rem;
    line-height: 1.6;
  }
  #tool-keywords { 
    color: var(--muted);
    font-size: 0.875rem;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 1rem;
  }
  #tool-keywords span {
    background: var(--elev);
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    border: 1px solid var(--border);
  }
  #tool-related {
    margin-top: 1rem;
    font-size: 0.875rem;
  }
  #tool-related a {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
    transition: color 0.2s ease;
  }
  #tool-related a:hover {
    color: var(--primary-light);
    text-decoration: underline;
  }

  /* Mobile */
  @media (max-width: 768px) {
    #content-wrapper { flex-direction: column; }
    body { flex-direction: column; overflow: hidden; }
    #topbar { 
      padding: 0.75rem 1rem; 
      gap: 0.75rem;
    }
    #topbar strong {
      font-size: 1.25rem;
    }
    #menu-button { 
      height: 40px; 
      width: 40px; 
      border-radius: var(--radius-sm);
      font-size: 16px;
    }
    .mui-textfield input#search {
      height: 40px; 
      font-size: 14px; 
      padding: 0.5rem 1rem 0.5rem 2.5rem;
    }
    #sidebar {
      width: 100%;
      max-height: 50vh;
      padding: 1rem;
      border: none;
      border-bottom: 1px solid var(--border);
      display: none;
      overflow-y: auto;
      overflow-x: hidden;
      background: var(--panel);
    }
    #tool-list {
      display: flex !important;
      flex-direction: column !important;
      gap: 0.25rem !important;
    }
    #main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
    #grid-view {
      grid-template-columns: 1fr;
      gap: 1rem;
      padding: 1rem;
      overflow-y: auto;
    }
    .card-frame { height: 180px; }
    .tool-card {
      padding: 1rem;
    }
    .tool-card h3 {
      font-size: 1rem;
    }
    .tool-card p {
      font-size: 0.813rem;
    }
    #viewer { overflow: auto; }
    #tool-frame, #viewer-placeholder { min-height: 50vh; }
    #viewer-controls { 
      padding: 0.75rem 1rem; 
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .mui-btn { 
      height: 36px; 
      line-height: 36px; 
      padding: 0 1rem; 
      font-size: 13px;
    }
    #tool-info { 
      padding: 1rem;
    }
    #tool-title { 
      font-size: 1.125rem;
    }
    #tool-description {
      font-size: 0.875rem;
    }
  }

  /* Nice scrolling and touch */
  #sidebar, #grid-view, #viewer { 
    -webkit-overflow-scrolling: touch; 
    scroll-behavior: smooth;
  }
  #tool-list li a { 
    min-height: 44px; 
    display: flex; 
    align-items: center;
    touch-action: manipulation;
  }

  /* Focus & motion preferences */
  :focus-visible { 
    outline: 2px solid var(--accent); 
    outline-offset: 2px; 
  }
  @media (prefers-reduced-motion: reduce) {
    * { transition: none !important; animation: none !important; }
  }

  /* Safe areas */
  @supports (padding: max(0px)) {
    #topbar { 
      padding-left: max(1rem, env(safe-area-inset-left));
      padding-right: max(1rem, env(safe-area-inset-right));
    }
    #grid-view, #tool-info { 
      padding-left: max(1.5rem, env(safe-area-inset-left));
      padding-right: max(1.5rem, env(safe-area-inset-right));
    }
  }

  /* Loading animation */
  .loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid var(--border);
    border-radius: 50%;
    border-top-color: var(--primary);
    animation: spin 1s ease-in-out infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Empty state */
  .empty-state {
    text-align: center;
    padding: 3rem 1rem;
    color: var(--muted);
  }
  .empty-state i {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
  }
  </style>
</head>
<body>
  <div id="topbar" aria-label="Toolbar">
    <button id="menu-button" aria-label="Toggle list">
      <i class="fas fa-bars"></i>
    </button>
    <strong>UpTooled</strong>
    <div class="mui-textfield">
      <input type="text" id="search" placeholder="Search tools..." inputmode="search" />
    </div>
  </div>
  <div id="content-wrapper">
    <div id="sidebar">
      <ul id="tool-list" class="mui-list--unstyled"></ul>
    </div>
    <div id="main">
      <div id="grid-view"></div>
      <div id="viewer" style="display:none; flex:1; flex-direction:column;">
        <div id="viewer-controls">
          <button id="back-button" class="mui-btn">
            <i class="fas fa-arrow-left"></i> Back
          </button>
          <button id="toggle-info" class="mui-btn">
            <i class="fas fa-info-circle"></i> Hide Info
          </button>
          <button id="edit-file" class="mui-btn mui-btn--primary" style="display:none;">
            <i class="fas fa-edit"></i> Edit File
          </button>
        </div>
        <iframe id="tool-frame" style="display:none;"></iframe>
        <div id="tool-info">
          <h3 id="tool-title"></h3>
          <p id="tool-description"></p>
          <div id="tool-keywords"></div>
          <p id="tool-related"></p>
        </div>
      </div>
    </div>
  </div>
  <script>
// Render sidebar list and iframe viewer for tools

async function init() {
  const res = await fetch('tools.json');
  const tools = await res.json();
  let external = [];
  try {
    const extRes = await fetch('external-sites.json');
    if (extRes.ok) {
      external = await extRes.json();
    }
  } catch (err) {
    console.error('Failed to load external sites', err);
  }
  const allTools = tools.concat(external.map(s => ({
    file: s.file || s.url,
    title: s.title || s.url,
    description: s.description || '',
    keywords: s.keywords || []
  })));

  const searchEl = document.getElementById('search');
  const listEl = document.getElementById('tool-list');
  const gridEl = document.getElementById('grid-view');
  const viewerEl = document.getElementById('viewer');
  const frameEl = document.getElementById('tool-frame');
  const titleEl = document.getElementById('tool-title');
  const descEl = document.getElementById('tool-description');
  const keysEl = document.getElementById('tool-keywords');
  const relatedEl = document.getElementById('tool-related');
  const backBtn = document.getElementById('back-button');
  const toggleInfoBtn = document.getElementById('toggle-info');
  const infoEl = document.getElementById('tool-info');
  const editFileBtn = document.getElementById('edit-file');
  const menuBtn = document.getElementById('menu-button');
  
  let selectedTool = null;

  function isMobile() {
    return window.matchMedia('(max-width: 768px)').matches;
  }

  function setSidebarVisible(show) {
    const sb = document.getElementById('sidebar');
    sb.style.display = show ? 'block' : 'none';
  }

  function matches(tool, q) {
    q = q.toLowerCase();
    return (
      tool.title.toLowerCase().includes(q) ||
      tool.description.toLowerCase().includes(q) ||
      (tool.keywords || []).some(k => k.toLowerCase().includes(q))
    );
  }

  function renderList(list) {
    listEl.innerHTML = '';
    list.forEach(tool => {
      const li = document.createElement('li');
      const link = document.createElement('a');
      link.href = '#';
      link.innerHTML = `<i class="fas fa-toolbox"></i> ${tool.title}`;
      link.addEventListener('click', e => {
        e.preventDefault();
        selectTool(tool);
      });
      li.appendChild(link);
      listEl.appendChild(li);
    });
  }

  function renderGrid(list) {
    gridEl.innerHTML = '';
    if (list.length === 0) {
      gridEl.innerHTML = `
        <div class="empty-state">
          <i class="fas fa-search"></i>
          <h3>No tools found</h3>
          <p>Try adjusting your search terms</p>
        </div>
      `;
      return;
    }

    for (const tool of list) {
      const card = document.createElement('div');
      card.className = 'tool-card';
      card.dataset.file = tool.file;
      
      const iframe = document.createElement('iframe');
      iframe.className = 'card-frame';
      iframe.src = tool.file;
      
      const title = document.createElement('h3');
      title.textContent = tool.title;
      
      const desc = document.createElement('p');
      desc.textContent = tool.description || '';
      
      card.appendChild(iframe);
      card.appendChild(title);
      card.appendChild(desc);
      
      card.addEventListener('click', () => selectTool(tool));
      gridEl.appendChild(card);
    }
  }

  function showGrid() {
    viewerEl.style.display = 'none';
    gridEl.style.display = 'grid';
    if (location.hash) {
      history.replaceState(null, '', location.pathname);
    }
    if (isMobile()) setSidebarVisible(true);
  }

  function showViewer() {
    gridEl.style.display = 'none';
    viewerEl.style.display = 'flex';
    if (localStorage.getItem('gh_token')) {
      editFileBtn.style.display = 'inline-flex';
    } else {
      editFileBtn.style.display = 'none';
    }
  }

  function selectTool(tool, updateHash = true) {
    if (isMobile()) setSidebarVisible(false);
    
    selectedTool = tool;
    frameEl.src = tool.file;
    frameEl.style.display = 'block';
    
    titleEl.textContent = tool.title;
    descEl.textContent = tool.description || '';
    
    // Enhanced keyword display
    keysEl.innerHTML = '';
    if (tool.keywords && tool.keywords.length) {
      const keywordContainer = document.createElement('div');
      tool.keywords.forEach(keyword => {
        const span = document.createElement('span');
        span.textContent = keyword;
        keywordContainer.appendChild(span);
      });
      keysEl.appendChild(keywordContainer);
    } else {
      keysEl.style.display = 'none';
    }
    
    relatedEl.innerHTML = '';
    if (tool.related && tool.related.length) {
      relatedEl.innerHTML = '<strong>Similar tools:</strong> ';
      tool.related.forEach((file, idx) => {
        const relTool = allTools.find(t => t.file === file);
        if (relTool) {
          const link = document.createElement('a');
          link.href = '#';
          link.innerHTML = `<i class="fas fa-external-link-alt"></i> ${relTool.title}`;
          link.addEventListener('click', e => {
            e.preventDefault();
            selectTool(relTool);
          });
          if (idx > 0) {
            relatedEl.appendChild(document.createTextNode(', '));
          }
          relatedEl.appendChild(link);
        }
      });
    }
    
    showViewer();
    if (updateHash) {
      location.hash = encodeURIComponent(tool.file);
    }
  }

  function filter() {
    const q = searchEl.value.trim();
    const filtered = q ? allTools.filter(t => matches(t, q)) : allTools;
    renderList(filtered);
    renderGrid(filtered);
    if (filtered.length === 0) {
      showGrid();
    }
  }

  function setInfoVisible(show) {
    infoEl.style.display = show ? 'block' : 'none';
    toggleInfoBtn.innerHTML = show ? 
      '<i class="fas fa-eye-slash"></i> Hide Info' : 
      '<i class="fas fa-info-circle"></i> Show Info';
  }

  searchEl.addEventListener('input', filter);
  backBtn.addEventListener('click', showGrid);
  
  setInfoVisible(!isMobile());
  
  toggleInfoBtn.addEventListener('click', () => {
    const show = infoEl.style.display === 'none';
    setInfoVisible(show);
  });

  editFileBtn.addEventListener('click', () => {
    if (selectedTool) {
      location.href = `edit.html?file=${encodeURIComponent(selectedTool.file)}`;
    }
  });

  menuBtn.addEventListener('click', () => {
    const sb = document.getElementById('sidebar');
    const visible = sb.style.display !== 'none';
    setSidebarVisible(!visible);
  });

  window.addEventListener('hashchange', () => {
    const file = decodeURIComponent(location.hash.slice(1));
    if (file) {
      const tool = allTools.find(t => t.file === file);
      if (tool) selectTool(tool, false);
    } else {
      showGrid();
    }
  });

  // Initialize
  renderList(allTools);
  renderGrid(allTools);
  
  // Close sidebar by default
  setSidebarVisible(false);
  
  const startFile = decodeURIComponent(location.hash.slice(1));
  if (startFile) {
    const tool = allTools.find(t => t.file === startFile);
    if (tool) {
      selectTool(tool, false);
    } else {
      showGrid();
    }
  } else {
    showGrid();
  }
}

document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
