<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Browse handy utilities and preview them inline.">
  <meta name="keywords" content="tools, gallery, productivity">
  <title>Tool Gallery</title>
  <link rel="preload" href="tools.json" as="fetch" crossorigin>
  <link rel="preload" href="external-sites.json" as="fetch" crossorigin>
  <link rel="preload" href="index.js" as="script">
  <script src="https://unpkg.com/dexie@latest/dist/dexie.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  <style>
    :root {
      --spacing: 1rem;
    }
    html, body {
      height: 100%;
    }
    body {
      margin: 0;
      display: flex;
      overflow: hidden;
    }
    aside {
      width: 280px;
      flex-shrink: 0;
      border-right: 1px solid var(--card-border-color, #ddd);
      overflow-y: auto;
      padding: var(--spacing);
    }
    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      background-color: var(--background-color);
    }
    #grid-view {
      display: grid;
      gap: var(--spacing);
      padding: var(--spacing);
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
    .tool-card {
      --card-padding: 0;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      overflow: hidden; /* Ensures rounded corners on children */
    }
    .tool-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--card-box-shadow, 0 5px 15px rgba(0,0,0,0.1));
    }
    .card-frame {
      width: 100%;
      height: 220px;
      border: 0;
      margin-bottom: 0;
      object-fit: cover;
      background-color: var(--muted-border-color);
    }
    .tool-card > h3, .tool-card > p {
        padding: 0 var(--spacing);
        margin-bottom: 0;
    }
    .tool-card > h3 {
        padding-top: var(--spacing);
        margin-bottom: calc(var(--spacing) / 2);
    }
     .tool-card > p {
        padding-bottom: var(--spacing);
        color: var(--muted-color);
        font-size: 0.9rem;
    }
    #tool-frame, #viewer-placeholder {
      flex: 1;
      border: 0;
      width: 100%;
      height: 100%;
    }
    #viewer { display: none; flex: 1; flex-direction: column; }
    #viewer-controls {
        padding: calc(var(--spacing) / 2) var(--spacing);
        border-bottom: 1px solid var(--card-border-color, #ddd);
        display: flex;
        gap: 0.5rem;
        background-color: var(--card-background-color);
    }
    #tool-info {
        padding: var(--spacing);
        border-top: 1px solid var(--card-border-color, #ddd);
        background-color: var(--card-background-color);
    }
    #tool-list {
        padding-left: 0;
        list-style: none;
        margin: 0;
    }
    #tool-list a {
        text-decoration: none;
        display: block;
        padding: 0.25rem 0;
    }
    #tool-list a:hover {
        color: var(--primary-hover);
    }
    @media (max-width: 768px) {
      body { flex-direction: column; }
      aside {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid var(--card-border-color, #ddd);
        height: auto;
        max-height: 40vh;
      }
    }
  </style>
</head>
<body>
  <aside>
    <label for="search">
        <input type="search" id="search" name="search" placeholder="Search tools...">
    </label>
    <ul id="tool-list"></ul>
  </aside>

  <main id="main">
    <div id="grid-view"></div>

    <div id="viewer">
      <div id="viewer-controls">
        <button id="back-button" class="secondary outline">Back</button>
        <button id="toggle-info" class="secondary outline">Hide Info</button>
        <button id="edit-file" class="secondary outline" style="display:none;">Edit File</button>
      </div>
      <img id="viewer-placeholder" style="display:none;"/>
      <iframe id="tool-frame" style="display:none;"></iframe>
      <div id="tool-info">
        <h3 id="tool-title"></h3>
        <p id="tool-description"></p>
        <small id="tool-keywords"></small>
      </div>
    </div>
  </main>

  <script src="index.js" defer></script>
</body>
</html>